<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kobook.mappers.boardMapper">

	<insert id="insertBoard" parameterType="BoardVO">
		insert into board(
		board_id, board_hit, board_date, board_content, board_title,
		board_writer
		)values(
		board_id_seq.nextval, 0, SYSDATE, #{board_content}, #{board_title}, #{board_writer}
		)
	</insert>

	<select id="listCriteria" resultType="BoardVO">
    <![CDATA[
          select 
            *
          from 
            board where board_id > 0           
      ]]>
		 <include refid="search"></include>
         <![CDATA[     
          order by board_date desc
       ]]>

	</select>

	<select id="read" resultType="BoardVO">
		select
		*
		from
		board
		where board_id = #{board_id}
	</select>


	<select id="maxNum" resultType="int">
		select MAX(board_id) from board
	</select>


	<select id="countPaging" resultType="int">
   <![CDATA[
      select count(board_id) from board where board_id > 0         
   ]]>      
   
     <include refid="search"></include>
   </select>


    <sql id="search">
      <if test="searchType != null">
         <if test="searchType == 't'.toString()">
            and board_title like '%'|| #{keyword}||'%'
         </if>
         <if test="searchType == 'c'.toString()">
            and board_content like '%'|| #{keyword}||'%'
         </if>
         <if test="searchType == 'tc'.toString()">
            and ( board_title like '%'|| #{keyword}||'%' OR board_content like
            '%'||
            #{keyword}||'%')
         </if>
      </if>
   </sql>

	<update id="boardUpdateView">
		update board set board_hit = board_hit +1 where board_id = #{board_id}
	</update>
	
	<delete id="boardRemove" parameterType="Integer">
		delete from board where board_id = #{board_id}
	</delete>
	
	 <update id="boardUpdate">
		update board set board_title = #{board_title}, board_content = #{board_content} 
		where board_id = #{board_id}
	</update> 


<!-- 관리자용 메인 sql문 -->
<!-- 	<select id="currentPerson" resultType="PersonVO">
		SELECT count(*) FROM v$session WHERE type='USER' order by PREV_EXEC_START;
	</select> -->

</mapper>











